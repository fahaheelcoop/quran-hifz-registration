<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>مسابقة حفظ القرآن الكريم 2026</title>

<style>
  *{box-sizing:border-box}
  body{font-family:Arial,sans-serif;background:#f6f7fb;margin:0;padding:40px}
  .card{max-width:520px;margin:auto;background:#fff;padding:28px;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.08)}
  h2{text-align:center;margin:0 0 18px}
  label{display:block;margin:14px 0 6px;font-weight:700}
  input{width:100%;padding:11px;border-radius:10px;border:1px solid #d8d8d8}
  button{width:100%;margin-top:18px;padding:13px 16px;background:#2e7d32;color:#fff;border:0;border-radius:12px;cursor:pointer;font-size:16px}
  button:hover{background:#256628}
  .msg{margin-top:12px;text-align:center}
  .err{color:#b00020}
  .ok{color:#1b5e20}
  .small{color:#666;font-size:13px;margin-top:8px;text-align:center}
</style>
</head>

<body>
<div class="card">
  <h2>التسجيل في مسابقة حفظ القرآن الكريم</h2>

  <!-- ✅ فورم مباشر للـ Apps Script (بدون fetch / بدون CORS) -->
  <form id="allowForm" method="POST" action="https://script.google.com/macros/s/AKfycbyo4zs3v4Qno0j_p5N-8qV2WR-HFG63nlrWR-F773WKLjj3cnDAg94zu9vVOMYvTngJ/exec" onsubmit="return onSubmitAllow()">
    <input type="hidden" name="action" value="checkAllowed">
    <input type="hidden" name="return_url" value="1">

    <label>الرقم المدني (ولي الأمر)</label>
    <input type="text" id="civil_id" name="guardian_civil_id" inputmode="numeric" placeholder="مثال: 123456789012" />

    <label>رقم الصندوق</label>
    <input type="text" id="box_number" name="box_number" inputmode="numeric" placeholder="مثال: 1234" />

    <button id="btn" type="submit">تحقق وابدأ التسجيل</button>

    <div class="msg" id="msg"></div>
    <div class="small">سيتم السماح فقط للأرقام الموجودة ضمن المسموح لهم.</div>
  </form>
</div>

<script>
function digits(x){ return String(x||"").replace(/\D+/g,""); }

function onSubmitAllow(){
  const btn = document.getElementById('btn');
  const msg = document.getElementById('msg');
  msg.textContent = '';
  msg.className = 'msg';

  // نظّف المدخلات (خليها أرقام فقط) قبل الإرسال
  const civilEl = document.getElementById('civil_id');
  const boxEl = document.getElementById('box_number');

  civilEl.value = digits(civilEl.value);
  boxEl.value = digits(boxEl.value);

  if(civilEl.value.length < 8 || boxEl.value.length < 1){
    msg.textContent = "من فضلك أدخل رقم مدني ورقم صندوق صحيحين.";
    msg.classList.add('err');
    return false; // امنع الإرسال
  }

  btn.disabled = true;
  btn.textContent = "جارٍ التحقق...";
  return true; // اسمح بالإرسال (هينقلك للـ Apps Script ثم يرجعك تلقائيًا)
}
</script>
</body>
</html>
